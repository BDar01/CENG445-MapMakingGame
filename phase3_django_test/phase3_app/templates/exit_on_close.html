<!-- exit_on_close.html -->

<script>
    window.addEventListener('beforeunload', function (event) {
        // Send an exit command to the server when the window is closed
        const exitCommand = {
            'command': 'E',
            'user_id': user_id  // Make sure to pass the user_id from your Django view or template context
        };

        // Serialize the data and send it using sendBeacon
        const data = JSON.stringify(exitCommand);
        navigator.sendBeacon('http://localhost:1423/exit-on-close/', data);
    });
</script>

